<!DOCTYPE html>
<html>
<head>
	<style>
	body {
		display: flex;
	    flex-direction: column;
	    align-items: center;
	    margin-top: 40px;
	    background-color: #fafafa;
	}
	#demo {
		padding: 30px;
	    border: 1px solid #ccc;
	    background-color: #efefef;
	    width: 30%;
	    display: flex;
	    flex-direction: column;
	    justify-content: center;
	}
	</style>
</head>
<body>

<h2>TRANSPILER.</h2>

<p id="demo"></p>

<script>

var res = "", i=0; 

var myObj = [];

// int a
var j2 = '{"_nodetype": "Decl", "bitsize": null, "coord": "examples/c_files/multi.c:2:6", "funcspec": [], "init": {"_nodetype": "Constant", "coord": "examples/c_files/multi.c:2:10", "type": "int", "value": "1"}, "name": "a", "quals": [], "storage": [], "type": {"_nodetype": "TypeDecl", "coord": "examples/c_files/multi.c:2:6", "declname": "a", "quals": [], "type": {"_nodetype": "IdentifierType", "coord": "examples/c_files/multi.c:2:2", "names": ["int"] } } }';

myObj[2] = JSON.parse(j2);
console.log(myObj[2]);

// , b
var j3 = '{"_nodetype": "Decl", "bitsize": null, "coord": "examples/c_files/multi.c:2:13", "funcspec": [], "init": null, "name": "b", "quals": [], "storage": [], "type": {"_nodetype": "TypeDecl", "coord": "examples/c_files/multi.c:2:13", "declname": "b", "quals": [], "type": {"_nodetype": "IdentifierType", "coord": "examples/c_files/multi.c:2:2", "names": ["int"] } } }';

myObj[3] = JSON.parse(j3);
console.log(myObj[3]);

// b = a op b
var j4 = '{   "_nodetype": "Assignment", "coord": "examples/c_files/multi.c:3:2", "lvalue": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:3:2", "name": "b"}, "op": "=", "rvalue": {"_nodetype": "BinaryOp", "coord": "examples/c_files/multi.c:3:6", "left": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:3:6", "name": "a"}, "op": "*", "right": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:3:8", "name": "b"} } }';

myObj[4] = JSON.parse(j4);
console.log(myObj[4]);

// printf()
var j5 = '{"_nodetype": "FuncCall", "args": {"_nodetype": "ExprList", "coord": "examples/c_files/multi.c:4:9", "exprs": [{"_nodetype": "Constant", "coord": "examples/c_files/multi.c:4:9", "type": "string", "value": "The answer is: %d"}, {"_nodetype": "ID", "coord": "examples/c_files/multi.c:4:29", "name": "b"}]}, "coord": "examples/c_files/multi.c:4:2", "name": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:4:2", "name": "printf"}}';

myObj[5] = JSON.parse(j5);
console.log(myObj[5]);

// if(a==b)
var j6 = '{"_nodetype": "If", "cond": {"_nodetype": "BinaryOp", "coord": "examples/c_files/multi.c:6:5", "left": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:6:5", "name": "a"}, "op": "==", "right": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:6:8", "name": "b"}}, "coord": "examples/c_files/multi.c:6:2", "iffalse": null, "iftrue": {"_nodetype": "Compound", "block_items": [{"_nodetype": "FuncCall", "args": {"_nodetype": "ExprList", "coord": "examples/c_files/multi.c:7:10", "exprs": [{"_nodetype": "Constant", "coord": "examples/c_files/multi.c:7:10", "type": "string", "value": "The answer is: %d"}, {"_nodetype": "ID", "coord": "examples/c_files/multi.c:7:30", "name": "c"}]}, "coord": "examples/c_files/multi.c:7:3", "name": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:7:3", "name": "printf"}}], "coord": "examples/c_files/multi.c:6:1"}}';

myObj[6] = JSON.parse(j6);
console.log(myObj[6]);

// // while(a==b)
// var j7 = '{"_nodetype": "While", "cond": {"_nodetype": "BinaryOp", "coord": "examples/c_files/multi.c:10:8", "left": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:10:8", "name": "c" }, "op": "==", "right": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:10:11", "name": "b"}}, "coord": "examples/c_files/multi.c:10:2", "stmt": {"_nodetype": "Compound", "block_items": [{"_nodetype": "FuncCall", "args": {"_nodetype": "ExprList", "coord": "examples/c_files/multi.c:11:10", "exprs": [{"_nodetype": "Constant", "coord": "examples/c_files/multi.c:11:10", "type": "string", "value": "The answer is: %d"}, {"_nodetype": "ID", "coord": "examples/c_files/multi.c:11:30", "name": "a"}]}, "coord": "examples/c_files/multi.c:11:3", "name": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:11:3", "name": "printf"}}], "coord": "examples/c_files/multi.c:10:1"}}';

// myObj[7] = JSON.parse(j7);
// console.log(myObj[7]);

// while(1)
var j8 = '{"_nodetype": "While", "cond": {"_nodetype": "Constant", "coord": "examples/c_files/multi.c:10:8", "type": "int", "value": "1"}, "coord": "examples/c_files/multi.c:10:2", "stmt": {"_nodetype": "Compound", "block_items": [{"_nodetype": "FuncCall", "args": {"_nodetype": "ExprList", "coord": "examples/c_files/multi.c:11:10", "exprs": [{"_nodetype": "Constant", "coord": "examples/c_files/multi.c:11:10", "type": "string", "value": "The answer is: %d"}, {"_nodetype": "ID", "coord": "examples/c_files/multi.c:11:30", "name": "a"}]}, "coord": "examples/c_files/multi.c:11:3", "name": {"_nodetype": "ID", "coord": "examples/c_files/multi.c:11:3", "name": "printf"}}], "coord": "examples/c_files/multi.c:10:1" } }';

myObj[8] = JSON.parse(j8);
console.log(myObj[8]);

// int main()
var j7 = '{"_nodetype": "Decl", "bitsize": null, "coord": "examples/c_files/multi.c:1:5", "funcspec": [], "init": null, "name": "main", "quals": [], "storage": [], "type": {"_nodetype": "FuncDecl", "args": null, "coord": "examples/c_files/multi.c:1:5", "type": {"_nodetype": "TypeDecl", "coord": "examples/c_files/multi.c:1:5", "declname": "main", "quals": [], "type": {"_nodetype": "IdentifierType", "coord": "examples/c_files/multi.c:1:1", "names": ["int"] } } } }';

myObj[7] = JSON.parse(j7);
console.log(myObj[7]);


for(i=2;i<myObj.length;i++) {
	if(myObj[i]._nodetype=='Decl') {
		if(myObj[i].name=='main') {
			res1 = 'public static void main(String[] args) {<br><br><span style="margin-left: 30px;">';
		}
		else {
			if(myObj[i].init!=null) {
				if(myObj[i].init._nodetype=='Constant') {
					res += myObj[i].init.type + " " + myObj[i].type.declname + " = "  + myObj[i].init.value;
				}
			}
			else if(myObj[i].init==null) {
				res += ", " + myObj[i].type.declname + ";" ;
			}
		}
	}
	if(myObj[i]._nodetype=='Assignment') {
		res += '</span><br><span style="margin-left: 30px;">' + myObj[i].lvalue.name + " " + myObj[i].op + " ";
		if(myObj[i].rvalue._nodetype=='BinaryOp') {
			if(myObj[i].rvalue.left._nodetype=='ID') {
				res +=  myObj[i].rvalue.left.name;
			}
			else {
				res +=  myObj[i].rvalue.left.value;	
			}
			res += " " + myObj[i].rvalue.op + " ";
			if(myObj[i].rvalue.right._nodetype=='ID') {
				res +=  myObj[i].rvalue.right.name;
			}
			else {
				res +=  myObj[i].rvalue.right.value + ';';	
			}
		}
		if(myObj[i].rvalue._nodetype=='UnaryOp') {
			res +=  myObj[i].rvalue.expr.name;
			res += myObj[i].rvalue.op.slice(1) + ";";
		}
	}
	if(myObj[i]._nodetype=='If') {
		res += '<br><br><span style="margin-left: 30px;">if('
		if(myObj[i].cond._nodetype=='BinaryOp') {
			if(myObj[i].cond.left._nodetype=='ID') {
				res +=  myObj[i].cond.left.name;
			}
			else {
				res +=  myObj[i].cond.left.value;	
			}
			res += " " + myObj[i].cond.op + " ";
			if(myObj[i].cond.right._nodetype=='ID') {
				res +=  myObj[i].cond.right.name;
			}
			else {
				res +=  myObj[i].cond.right.value;	
			}
			res += ')</span> {<br><span style="margin-left: 60px;">';
			if(myObj[i].iffalse==null) {
				if(myObj[i].iftrue.block_items[0].name.name=='printf') {
					res += 'System.out.print(" ';
				}
				if(myObj[i].iftrue.block_items[0].args._nodetype=='ExprList') {
					for(j=0;j<myObj[i].iftrue.block_items[0].args.exprs.length-1;j++) {
						if(myObj[i].iftrue.block_items[0].args.exprs[j]._nodetype=='Constant') {
							res +=  myObj[i].iftrue.block_items[0].args.exprs[j].value.slice(0,-2) + '';
						}
						else {
							res +=  myObj[i].iftrue.block_items[0].args.exprs[j].name + ', ';
						}
					}
					if(myObj[i].iftrue.block_items[0].args.exprs[j]._nodetype=='Constant') {
						res +=  '" + '+ myObj[i].iftrue.block_items[0].args.exprs[j].value + ');<br><span style="margin-left: 30px;">}</span><br>';
					}
					else {
						res +=  '" + '+ myObj[i].iftrue.block_items[0].args.exprs[j].name + ');<br><span style="margin-left: 30px;">}</span><br>';
					}
				}
			}
		}
	}
	if(myObj[i]._nodetype=='While') {
		res += '<br><span style="margin-left: 30px;">while('
		if(myObj[i].cond._nodetype=='BinaryOp') {
			if(myObj[i].cond.left._nodetype=='ID') {
				res +=  myObj[i].cond.left.name;
			}
			else {
				res +=  myObj[i].cond.left.value;	
			}
			res += " " + myObj[i].cond.op + " ";
			if(myObj[i].cond.right._nodetype=='ID') {
				res +=  myObj[i].cond.right.name;
			}
			else {
				res +=  myObj[i].cond.right.value;	
			}
			res += ')</span> {<br><span style="margin-left: 60px;">';
			if(myObj[i].iffalse==null) {
				if(myObj[i].stmt.block_items[0].name.name=='printf') {
					res += 'System.out.print(" ';
				}
				if(myObj[i].stmt.block_items[0].args._nodetype=='ExprList') {
					for(j=0;j<myObj[i].stmt.block_items[0].args.exprs.length-1;j++) {
						if(myObj[i].stmt.block_items[0].args.exprs[j]._nodetype=='Constant') {
							res +=  myObj[i].stmt.block_items[0].args.exprs[j].value.slice(0,-2) + '';
						}
						else {
							res +=  myObj[i].stmt.block_items[0].args.exprs[j].name + ', ';
						}
					}
					if(myObj[i].stmt.block_items[0].args.exprs[j]._nodetype=='Constant') {
						res +=  '" + '+ myObj[i].stmt.block_items[0].args.exprs[j].value + ');<br><span style="margin-left: 30px;">}</span><br>';
					}
					else {
						res +=  '" + '+ myObj[i].stmt.block_items[0].args.exprs[j].name + ');<br><span style="margin-left: 30px;">}</span><br>';
					}
				}
			}
		}
		else {
			res +=  myObj[i].cond.value + ')</span> {<br><span style="margin-left: 60px;">';
			if(myObj[i].iffalse==null) {
				if(myObj[i].stmt.block_items[0].name.name=='printf') {
					res += 'System.out.print(" ';
				}
				if(myObj[i].stmt.block_items[0].args._nodetype=='ExprList') {
					for(j=0;j<myObj[i].stmt.block_items[0].args.exprs.length-1;j++) {
						if(myObj[i].stmt.block_items[0].args.exprs[j]._nodetype=='Constant') {
							res +=  myObj[i].stmt.block_items[0].args.exprs[j].value.slice(0,-2) + '';
						}
						else {
							res +=  myObj[i].stmt.block_items[0].args.exprs[j].name + ', ';
						}
					}
					if(myObj[i].stmt.block_items[0].args.exprs[j]._nodetype=='Constant') {
						res +=  '" + '+ myObj[i].stmt.block_items[0].args.exprs[j].value + ');<br><span style="margin-left: 30px;">}</span><br>';
					}
					else {
						res +=  '" + '+ myObj[i].stmt.block_items[0].args.exprs[j].name + ');<br><span style="margin-left: 30px;">}</span><br>';
					}
				}
			}
		}
	}
	if(myObj[i]._nodetype=='FuncCall') {
		if(myObj[i].name.name=='printf') {
			res += '<br><span style="margin-left: 30px;">System.out.print(" ';
		}
		if(myObj[i].args._nodetype=='ExprList') {
			for(j=0;j<myObj[i].args.exprs.length-1;j++) {
				if(myObj[i].args.exprs[j]._nodetype=='Constant') {
					res +=  myObj[i].args.exprs[j].value.slice(0,-2) + '';
				}
				else {
					res +=  myObj[i].args.exprs[j].name + ', ';
				}
			}
			if(myObj[i].args.exprs[j]._nodetype=='Constant') {
				res +=  '" + '+ myObj[i].args.exprs[j].value + ');</span>';
			}
			else {
				res +=  '" + '+ myObj[i].args.exprs[j].name + ');';
			}
		}
	}
	if(myObj[i]._nodetype=='Return') {
		res +=  '<br><span style="margin-left: 30px;">return ' + myObj[i].expr.value +";<br>";
	}
}
res2 = "<br>}<br>" + '<span style="margin-left: -30px;">}</span>';

var res1 = 'package util; <br><br>public class SpmProject { <br><br><span style="margin-left: 30px;">'+res1;
var res3 = res1.concat(res);
var res4 = res3.concat(res2);

document.getElementById('demo').innerHTML = res4;

</script>

</body>
</html>
